<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MealFinder</title>
  <link rel="stylesheet" href="main.css" />
</head>
<body>
  <!-- Navbar -->
  <nav>
    <div class="nav-left" onclick="goHome()">
      <img src="https://cdn-icons-png.flaticon.com/512/1046/1046857.png" alt="logo">
      <h1 class="logo">MealFinder</h1>
    </div>
    <div class="nav-right">
      <button class="menu-toggle" id="menu-toggle" onclick="toggleMenu()" aria-label="Open menu">‚ò∞</button>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero" role="banner">
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <div class="search-bar">
        <input id="search-input" type="text" placeholder="Search recipes here...">
        <button class="search-btn" onclick="performSearch()">üîç</button>
      </div>
      <div style="margin-top: 30px;"></div>
      <h2 class="hero-text-top">What are your favorite cuisines?</h2>
      <div style="margin-top: 20px;"></div>
      <p class="hero-text-bottom">PERSONALIZE YOUR EXPERIENCE</p>
    </div>
  </section>

  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <button class="sidebar-close" onclick="closeMenu()" aria-label="Close menu">‚úï</button>
    <ul>
      <li onclick="showCategory('Beef'); closeMenu();">Beef</li>
      <li onclick="showCategory('Chicken'); closeMenu();">Chicken</li>
      <li onclick="showCategory('Dessert'); closeMenu();">Dessert</li>
      <li onclick="showCategory('Seafood'); closeMenu();">Seafood</li>
      <li onclick="showCategory('Vegan'); closeMenu();">Vegan</li>
      <li onclick="showCategory('Pasta'); closeMenu();">Pasta</li>
      <li onclick="showCategory('Pork'); closeMenu();">Pork</li>
      <li onclick="showCategory('Starter'); closeMenu();">Starter</li>
      <li onclick="showCategory('Vegetarian'); closeMenu();">Vegetarian</li>
      <li onclick="showCategory('Breakfast'); closeMenu();">Breakfast</li>
      <li onclick="showCategory('Miscellaneous'); closeMenu();">Miscellaneous</li>
      <li onclick="showCategory('Lamb'); closeMenu();">Lamb</li>
      <li onclick="showCategory('Side'); closeMenu();">Side</li>
      <li onclick="showCategory('Goat'); closeMenu();">Goat</li>
    </ul>
  </div>

  <!-- PAGE 1: Home - Display Categories -->
  <main id="home-page" class="page">
    <section class="categories">
      <h2>CATEGORIES</h2>
      <div class="category-grid" id="category-grid"></div>
    </section>
  </main>

  <!-- PAGE 2: Category Detail - Display Meals + Categories Below -->
  <section id="category-detail" class="page hidden">
    <div class="page-content">
      <!-- Category Info & Meals -->
      <div class="category-box">
        <div class="category-info">
          <h2 id="cat-title"></h2>
          <p id="cat-info"></p>
          <button class="back-btn" onclick="goHome()">‚Üê Back to Home</button>
        </div>
        <div class="meals-grid" id="meals-grid"></div>
      </div>

      <!-- Categories Section Below -->
      <section class="categories">
        <h2>EXPLORE MORE CATEGORIES</h2>
        <div class="category-grid" id="category-grid-2"></div>
      </section>
    </div>
  </section>

  <!-- PAGE 3: Meal Detail - Display Meal Info + Categories Below -->
  <section id="meal-detail" class="page hidden">
    <div class="page-content">
      <!-- Breadcrumb -->
      <div class="meal-breadcrumb">
        <span class="breadcrumb-icon">üè†</span>
        <span id="meal-breadcrumb-text">Meal Name</span>
      </div>

      <!-- Meal Details Heading -->
      <div class="meal-details-header">
        <h1>MEAL DETAILS</h1>
      </div>

      <!-- Meal Info Container -->
      <div class="meal-container">
        <div class="meal-left">
          <img id="meal-img" alt="Meal Image" class="meal-image">
        </div>

        <div class="meal-right">
          <h2 id="meal-name" class="meal-title"></h2>
          
          <div class="meal-meta">
            <div class="meta-item">
              <span class="meta-label">CATEGORY:</span>
              <span id="meal-category" class="meta-value"></span>
            </div>
            <div class="meta-item">
              <span class="meta-label">Source:</span>
              <a id="meal-source" href="#" target="_blank" class="meta-value"></a>
            </div>
            <div class="meta-item">
              <span class="meta-label">Tags:</span>
              <span id="meal-tags" class="meta-value"></span>
            </div>
          </div>

          <!-- Ingredients Box - Orange Background with Badges -->
          <div class="ingredients-box">
            <h3>Ingredients</h3>
            <div id="meal-ingredients" class="ingredient-grid"></div>
          </div>

          <button class="back-btn" onclick="backToCategory()">‚Üê Back to Category</button>
        </div>
      </div>

      <!-- Measures Section -->
      <div class="measures-section">
        <h3>Measure:</h3>
        <div id="meal-measures" class="measure-grid"></div>
      </div>

      <!-- Instructions Section -->
      <div class="instructions-section">
        <h3>Instructions:</h3>
        <ul id="meal-instructions" class="instructions-list"></ul>
      </div>

      <!-- Categories Section Below -->
      <section class="categories">
        <h2>EXPLORE MORE CATEGORIES</h2>
        <div class="category-grid" id="category-grid-3"></div>
      </section>
    </div>
  </section>

  <script>
    const categoryGrid = document.getElementById('category-grid');
    const categoryGrid2 = document.getElementById('category-grid-2');
    const categoryGrid3 = document.getElementById('category-grid-3');
    const catDetail = document.getElementById('category-detail');
    const mealDetail = document.getElementById('meal-detail');
    const homePage = document.getElementById('home-page');
    const mealsGrid = document.getElementById('meals-grid');

    const CATEGORIES_API = 'https://www.themealdb.com/api/json/v1/1/categories.php';
    const CATEGORY_MEALS_API = 'https://www.themealdb.com/api/json/v1/1/filter.php?c=';
    const MEAL_DETAIL_API = 'https://www.themealdb.com/api/json/v1/1/lookup.php?i=';
    const SEARCH_MEAL_API = 'https://www.themealdb.com/api/json/v1/1/search.php?s=';

    function toggleMenu() {
      const sidebar = document.getElementById('sidebar');
      const menuToggle = document.getElementById('menu-toggle');
      sidebar.classList.toggle('active');
      
      if (sidebar.classList.contains('active')) {
        menuToggle.textContent = '‚úï';
      } else {
        menuToggle.textContent = '‚ò∞';
      }
    }

    function closeMenu() {
      const sidebar = document.getElementById('sidebar');
      const menuToggle = document.getElementById('menu-toggle');
      sidebar.classList.remove('active');
      menuToggle.textContent = '‚ò∞';
    }

    // PAGE NAVIGATION - Go to Home Page
    function goHome() {
      homePage.classList.remove('hidden');
      catDetail.classList.add('hidden');
      mealDetail.classList.add('hidden');
      loadCategories();
      window.scrollTo({ top: 0, behavior: "smooth" });
      closeMenu();
    }

    // Load categories for all grids
    async function loadCategories() {
      const res = await fetch(CATEGORIES_API);
      const data = await res.json();
      const cardsHTML = data.categories.map(cat => `
        <div class="card" onclick="showCategory('${cat.strCategory}')">
          <img src="${cat.strCategoryThumb}" alt="${cat.strCategory}">
          <span class="label">${cat.strCategory}</span>
        </div>
      `).join('');
      
      categoryGrid.innerHTML = cardsHTML;
      categoryGrid2.innerHTML = cardsHTML;
      categoryGrid3.innerHTML = cardsHTML;
    }

    // Show category and its meals (PAGE 2)
    async function showCategory(category) {
      homePage.classList.add('hidden');
      mealDetail.classList.add('hidden');
      catDetail.classList.remove('hidden');

      const res = await fetch(CATEGORY_MEALS_API + category);
      const data = await res.json();

      document.getElementById('cat-title').textContent = category + " Dishes";
      document.getElementById('cat-info').textContent =
        `Explore our delicious ${category} recipes crafted with love.`;

      let mealsToShow = (data.meals || []).slice(0, category === 'Goat' ? 7 : 6);
      mealsGrid.innerHTML = mealsToShow.map(meal => `
        <div class="meal-card" onclick="showMeal('${meal.idMeal}')">
          <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
          <p>${meal.strMeal}</p>
        </div>
      `).join('');

      // Load categories below
      loadCategories();
      window.scrollTo({ top: 0, behavior: "smooth" });
      closeMenu();
    }

    // Search for meal - Display as category detail with all results
    async function performSearch() {
      const query = document.getElementById('search-input').value.trim();
      if (!query) return alert("Please enter a meal name!");
      const res = await fetch(SEARCH_MEAL_API + query);
      const data = await res.json();
      if (data.meals && data.meals.length > 0) {
        // Show category detail with search results
        homePage.classList.add('hidden');
        mealDetail.classList.add('hidden');
        catDetail.classList.remove('hidden');

        document.getElementById('cat-title').textContent = `Search Results for "${query}"`;
        document.getElementById('cat-info').textContent =
          `Found ${data.meals.length} meal(s) matching your search.`;

        mealsGrid.innerHTML = data.meals.map(meal => `
          <div class="meal-card" onclick="showMeal('${meal.idMeal}')">
            <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
            <p>${meal.strMeal}</p>
          </div>
        `).join('');

        loadCategories();
        window.scrollTo({ top: 0, behavior: "smooth" });
        closeMenu();
      } else alert("No meal found.");
    }

    document.getElementById("search-input").addEventListener("keypress", e => {
      if (e.key === "Enter") performSearch();
    });

    // Show meal details (PAGE 3)
    async function showMeal(id) {
      catDetail.classList.add('hidden');
      mealDetail.classList.remove('hidden');

      const res = await fetch(MEAL_DETAIL_API + id);
      const data = await res.json();
      const meal = data.meals[0];

      // Breadcrumb
      document.getElementById('meal-breadcrumb-text').textContent = meal.strMeal;

      document.getElementById('meal-img').src = meal.strMealThumb;
      document.getElementById('meal-name').textContent = meal.strMeal;
      document.getElementById('meal-category').textContent = meal.strCategory;
      document.getElementById('meal-source').textContent = meal.strSource || 'Not Available';
      document.getElementById('meal-source').href = meal.strSource || '#';
      document.getElementById('meal-tags').textContent = meal.strTags || 'None';

      const ingredients = [];
      for (let i = 1; i <= 20; i++) {
        const ing = meal[`strIngredient${i}`];
        if (ing && ing.trim()) ingredients.push(ing.trim());
      }
      document.getElementById('meal-ingredients').innerHTML = ingredients
        .map((ing, idx) => `<div class="ingredient-item"><span class="circle">${idx + 1}</span> ${ing}</div>`)
        .join('');

      const measures = [];
      for (let i = 1; i <= 20; i++) {
        const ing = meal[`strIngredient${i}`];
        const meas = meal[`strMeasure${i}`];
        if (ing && ing.trim()) measures.push(`ü•Ñ ${meas ? meas.trim() : ''} ${ing}`);
      }
      document.getElementById('meal-measures').innerHTML = measures
        .map(m => `<div class="measure-item">${m}</div>`).join('');

      const steps = (meal.strInstructions || "").split(/\r?\n/).filter(s => s.trim());
      document.getElementById('meal-instructions').innerHTML =
        steps.map(s => `<li>‚úÖ ${s}</li>`).join('');

      // Load categories below
      loadCategories();
      window.scrollTo({ top: 0, behavior: "smooth" });
      closeMenu();
    }

    // Back to category detail
    function backToCategory() {
      mealDetail.classList.add('hidden');
      catDetail.classList.remove('hidden');
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    // Initialize on page load
    loadCategories();
  </script>
</body>
</html>